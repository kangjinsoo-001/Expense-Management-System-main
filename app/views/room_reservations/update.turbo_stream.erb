<%# tbody ì „ì²´ë¥¼ êµì²´í•˜ì—¬ Stimulus ì»¨íŠ¸ë¡¤ëŸ¬ ì¬ì—°ê²° %>
<% Rails.logger.info "ğŸ¯ [update.turbo_stream] ì „ë‹¬í•  íšŒì˜ì‹¤ ê°œìˆ˜: #{@filtered_rooms&.count}" %>
<% Rails.logger.info "ğŸ¯ [update.turbo_stream] íšŒì˜ì‹¤ ëª©ë¡: #{@filtered_rooms&.map(&:name)&.join(', ')}" %>
<%= turbo_stream.replace "calendar_grid" do %>
  <tbody id="calendar_grid" 
         class="bg-white">
    <%= render partial: 'calendar_grid', locals: { 
      filtered_rooms: @filtered_rooms, 
      reservations: @reservations, 
      date: @date, 
      current_user: current_user,
      highlight_reservation_id: @highlight_reservation_id
    } %>
  </tbody>
<% end %>

<%# í¸ì§‘ ëª¨ë‹¬ ìˆ¨ê¸°ê¸° - JavaScriptë¡œ ì²˜ë¦¬ %>
<%= turbo_stream.append "flash_messages" do %>
  <script>
    (function() {
      const editModal = document.getElementById('editReservationModal');
      if (editModal) {
        editModal.classList.add('hidden');
      }
      
      // ìº˜ë¦°ë” ì—´ ê°œìˆ˜ í™•ì¸
      setTimeout(() => {
        const calendarGrid = document.getElementById('calendar_grid');
        if (calendarGrid) {
          const firstRow = calendarGrid.querySelector('tbody tr');
          if (firstRow) {
            const cells = firstRow.querySelectorAll('td[data-room-id]');
            console.log('ğŸ¢ ë Œë”ë§ëœ ìº˜ë¦°ë” ì—´ ê°œìˆ˜:', cells.length);
            console.log('ğŸ¢ ê° ì—´ì˜ íšŒì˜ì‹¤ ID:', Array.from(cells).map(td => td.dataset.roomId));
          }
        }
        
        // í•„í„° ìƒíƒœ í™•ì¸
        const locationFilter = document.querySelector('#location-filter');
        if (locationFilter) {
          console.log('ğŸ“ í˜„ì¬ í•„í„° ì„ íƒê°’:', locationFilter.value || 'ì „ì²´');
        }
      }, 100);
    })();
  </script>
<% end %>