<% # Turbo Stream에서 전달된 경우 message와 type 변수 사용 %>
<% if defined?(message) && defined?(type) %>
  <% type_class = case type.to_s
     when 'notice', 'success'
       'bg-green-50 border-green-400 text-green-800'
     when 'alert', 'error'
       'bg-red-50 border-red-400 text-red-800'
     when 'warning'
       'bg-yellow-50 border-yellow-400 text-yellow-800'
     else
       'bg-blue-50 border-blue-400 text-blue-800'
     end %>
  
  <div class="<%= type_class %> px-4 py-3 rounded relative mb-4 border" role="alert" data-controller="flash">
    <span class="block sm:inline"><%= message %></span>
    <button type="button" class="absolute top-0 bottom-0 right-0 px-4 py-3" data-action="click->flash#close">
      <svg class="fill-current h-6 w-6 text-gray-500" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
        <title>Close</title>
        <path d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"/>
      </svg>
    </button>
  </div>
<% else %>
  <% # 일반 flash 처리 %>
  <% flash_to_show = local_assigns[:flash] || flash %>
  <% if flash_to_show[:notice].present? %>
    <div class="bg-green-50 border border-green-400 text-green-800 px-4 py-3 rounded relative mb-4" role="alert" data-controller="flash">
      <span class="block sm:inline"><%= flash_to_show[:notice] %></span>
      <button type="button" class="absolute top-0 bottom-0 right-0 px-4 py-3" data-action="click->flash#close">
        <svg class="fill-current h-6 w-6 text-green-500" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
          <title>Close</title>
          <path d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"/>
        </svg>
      </button>
    </div>
  <% end %>

  <% if flash_to_show[:alert].present? %>
    <div class="bg-red-50 border border-red-400 text-red-800 px-4 py-3 rounded relative mb-4" role="alert" data-controller="flash">
      <span class="block sm:inline"><%= flash_to_show[:alert] %></span>
      <button type="button" class="absolute top-0 bottom-0 right-0 px-4 py-3" data-action="click->flash#close">
        <svg class="fill-current h-6 w-6 text-red-500" role="button" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
          <title>Close</title>
          <path d="M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.029a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"/>
        </svg>
      </button>
    </div>
  <% end %>
<% end %>