<div class="max-w-4xl mx-auto">
  <!-- Flash 메시지 영역 -->
  <div id="flash_messages"></div>
  
  <!-- 헤더 영역 -->
  <div class="mb-6">
    <div class="flex items-center gap-3">
      <%= link_to expense_sheets_path, 
                  class: "inline-flex items-center justify-center w-10 h-10 rounded-md hover:bg-gray-100 transition-colors" do %>
        <svg class="h-5 w-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
      <% end %>
      <div>
        <h1 class="text-2xl font-semibold text-gray-900">새 경비 항목 추가</h1>
        <p class="mt-1 text-sm text-gray-500">
          <%= "#{@expense_sheet.year}년 #{@expense_sheet.month}월 경비 시트" %>
        </p>
      </div>
    </div>
  </div>

  <!-- 임시 저장 복원 메시지 -->
  <% if @draft_restore_message.present? && @draft_id.present? %>
    <div class="mb-4 p-4 bg-green-50 border border-green-200 rounded-lg" 
         data-controller="draft-restore-notification"
         data-draft-restore-notification-delete-url-value="<%= delete_draft_expense_sheet_expense_item_path(@expense_sheet, @draft_id) %>">
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <svg class="h-5 w-5 text-green-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <p class="text-sm text-green-700">
            <%= @draft_restore_message %>
          </p>
        </div>
        <button type="button" 
                data-action="click->draft-restore-notification#cancelAndDelete"
                class="px-3 py-1 bg-white text-gray-700 text-sm rounded border border-gray-300 hover:bg-gray-50">
          취소 후 임시 저장 제거
        </button>
      </div>
    </div>
  <% end %>

  <!-- 임시 저장된 항목이 있을 때 복원 옵션 표시 -->
  <% if @draft_item && params[:restore_draft] != 'true' %>
    <div data-controller="draft-notification" 
         data-draft-notification-delete-url-value="<%= delete_draft_expense_sheet_expense_item_path(@expense_sheet, @draft_item) %>"
         class="mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg">
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <svg class="h-5 w-5 text-blue-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <p class="text-sm text-blue-700">
            임시 저장된 항목이 있습니다. 
            <span class="text-xs text-blue-600">(<%= @draft_item.draft_status_message %>)</span>
          </p>
        </div>
        <div class="flex gap-2">
          <%= link_to "불러오기", 
                      restore_draft_expense_sheet_expense_item_path(@expense_sheet, @draft_item),
                      method: :post,
                      data: { turbo_method: :post },
                      class: "px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700" %>
          <button type="button" 
                  data-action="click->draft-notification#deleteDraft"
                  class="px-3 py-1 bg-white text-gray-700 text-sm rounded border border-gray-300 hover:bg-gray-50">
            제거
          </button>
        </div>
      </div>
    </div>
  <% end %>

  <!-- 폼 영역 -->
  <div class="tremor-card">
    <div class="p-6">
      <%= render partial: "form", locals: { 
        expense_item: @expense_item, 
        expense_sheet: @expense_sheet,
        expense_codes: @expense_codes,
        cost_centers: @cost_centers
      } %>
    </div>
  </div>
</div>