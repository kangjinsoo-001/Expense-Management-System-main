<%= form_with url: update_members_admin_approver_group_path(approver_group),
              method: :patch,
              class: "space-y-4",
              data: { 
                turbo_frame: "_top",
                action: "turbo:submit-end->approver-group#membersUpdated",
                controller: "approver-group-multiselect"
              } do |form| %>
  <div>
    <%= form.label :user_ids, '그룹 멤버', class: 'block text-sm font-medium text-gray-700 mb-2' %>
    <select name="user_ids[]" 
            multiple
            data-choices
            data-placeholder="사용자를 검색하여 선택하세요"
            data-approver-group-multiselect-target="userSelect"
            data-selected-values="<%= current_members.map { |m| m.user_id }.to_json %>"
            class="mt-1 block w-full">
      <% all_users.each do |user| %>
        <option value="<%= user.id %>" 
                <%= 'selected' if current_members.any? { |m| m.user_id == user.id } %>>
          <%= user.name %> (<%= user.organization&.name || '소속 없음' %>)
        </option>
      <% end %>
    </select>
  </div>
  
  <div class="flex gap-2">
    <%= form.submit '멤버 저장', class: 'btn btn-primary' %>
    <button type="button" 
            data-action="click->approver-group#cancelEdit"
            class="btn btn-secondary">
      취소
    </button>
  </div>
<% end %>