<%# 디버깅용 간소화된 AI 분석 결과 표시 %>
<div class="mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded">
  <div class="font-bold text-red-600 mb-2">디버깅: AI 분석 결과</div>
  
  <div class="text-xs text-gray-600 mb-2">
    <p>attachment.completed?: <%= attachment.completed? %></p>
    <p>attachment.status: <%= attachment.status %></p>
    <p>attachment.processing_stage: <%= attachment.processing_stage %></p>
    <p>analysis_result present?: <%= attachment.analysis_result.present? %></p>
    <p>analysis_result keys: <%= attachment.analysis_result.keys.join(', ') if attachment.analysis_result %></p>
  </div>
  
  <% if attachment.analysis_result && attachment.analysis_result['summary_data'] %>
    <% summary_data = attachment.analysis_result['summary_data'] %>
    <div class="text-xs text-blue-600 mb-2">
      <p>summary_data present?: <%= summary_data.present? %></p>
      <p>summary_data keys: <%= summary_data.keys.join(', ') if summary_data %></p>
    </div>
    
    <% if summary_data['transactions'] %>
      <div class="bg-white p-2 rounded">
        <p class="font-medium text-green-600">거래 내역 (<%= summary_data['transactions'].size %>건)</p>
        <table class="w-full text-xs mt-2">
          <thead>
            <tr class="border-b">
              <th class="text-left">날짜</th>
              <th class="text-left">가맹점</th>
              <th class="text-right">금액</th>
            </tr>
          </thead>
          <tbody>
            <% summary_data['transactions'].each do |t| %>
              <tr class="border-b">
                <td><%= t['usage_date'] %></td>
                <td><%= t['merchant_name'] %></td>
                <td class="text-right"><%= number_to_currency(t['total_amount'], unit: "₩", precision: 0) %></td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <p class="text-red-600">transactions 없음</p>
    <% end %>
  <% else %>
    <p class="text-red-600">summary_data 없음</p>
  <% end %>
</div>