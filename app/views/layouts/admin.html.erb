<!DOCTYPE html>
<html>
  <head>
    <title>경비 관리</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <!-- 파비콘 설정 (talenx) -->
    <link rel="shortcut icon" href="/favicon.ico?v=<%= Time.current.to_i %>" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?v=<%= Time.current.to_i %>" type="image/x-icon">
    <link rel="icon" href="/icon.png?v=<%= Time.current.to_i %>" type="image/png" sizes="512x512">
    <link rel="apple-touch-icon" href="/icon.png?v=<%= Time.current.to_i %>">

    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <%= javascript_importmap_tags %>
  </head>

  <body>
    <div class="min-h-screen bg-gray-100">
      <!-- Navigation -->
      <nav class="bg-white shadow">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          <div class="flex justify-between h-16">
            <div class="flex">
              <div class="flex-shrink-0 flex items-center">
                <h1 class="text-xl font-bold">경비 시스템 관리자</h1>
              </div>
              <div class="hidden sm:ml-6 sm:flex sm:items-center sm:space-x-2">
                <!-- 인사 정보 드롭다운 -->
                <div class="relative" data-controller="dropdown">
                  <button type="button" 
                          data-action="click->dropdown#toggle"
                          data-dropdown-target="button"
                          class="inline-flex items-center px-2 py-2 border-b-2 <%= current_page?(organizations_path) || current_page?(users_path) ? 'border-indigo-500 text-gray-900' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300' %> text-sm font-medium whitespace-nowrap">
                    인사 정보
                    <svg class="ml-1 h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </button>
                  <div class="hidden absolute z-10 left-0 mt-1 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5"
                       data-dropdown-target="menu">
                    <div class="py-1">
                      <%= link_to "조직 관리", organizations_path,
                          class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
                      <%= link_to "사용자 관리", users_path,
                          class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
                    </div>
                  </div>
                </div>

                <!-- 경비 드롭다운 -->
                <div class="relative" data-controller="dropdown">
                  <button type="button"
                          data-action="click->dropdown#toggle"
                          data-dropdown-target="button"
                          class="inline-flex items-center px-2 py-2 border-b-2 <%= current_page?(admin_expense_sheets_path) || current_page?(admin_closing_dashboard_index_path) || current_page?(admin_cost_centers_path) || current_page?(admin_expense_codes_path) || current_page?(admin_attachment_requirements_path) ? 'border-indigo-500 text-gray-900' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300' %> text-sm font-medium whitespace-nowrap">
                    경비
                    <svg class="ml-1 h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </button>
                  <div class="hidden absolute z-10 left-0 mt-1 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5"
                       data-dropdown-target="menu">
                    <div class="py-1">
                      <%= link_to "경비 마감 관리", admin_closing_dashboard_index_path,
                          class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
                      <%= link_to "경비 시트 관리", admin_expense_sheets_path,
                          class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
                      <%= link_to "코스트 센터", admin_cost_centers_path,
                          class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
                      <%= link_to "경비 코드", admin_expense_codes_path,
                          class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
                      <%= link_to "첨부파일 AI 분석", admin_attachment_requirements_path,
                          class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
                      <%= link_to "시트 승인 규칙", admin_expense_sheet_approval_rules_path,
                          class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
                    </div>
                  </div>
                </div>

                <!-- 신청서 드롭다운 -->
                <div class="relative" data-controller="dropdown">
                  <button type="button"
                          data-action="click->dropdown#toggle"
                          data-dropdown-target="button"
                          class="inline-flex items-center px-2 py-2 border-b-2 <%= current_page?(admin_request_categories_path) || current_page?(admin_request_templates_path) ? 'border-indigo-500 text-gray-900' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300' %> text-sm font-medium whitespace-nowrap">
                    신청서
                    <svg class="ml-1 h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </button>
                  <div class="hidden absolute z-10 left-0 mt-1 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5"
                       data-dropdown-target="menu">
                    <div class="py-1">
                      <%= link_to "카테고리", admin_request_categories_path,
                          class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
                      <%= link_to "템플릿", admin_request_templates_path,
                          class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
                    </div>
                  </div>
                </div>

                <!-- 회의실 드롭다운 -->
                <div class="relative" data-controller="dropdown">
                  <button type="button"
                          data-action="click->dropdown#toggle"
                          data-dropdown-target="button"
                          class="inline-flex items-center px-2 py-2 border-b-2 <%= current_page?(admin_room_categories_path) || current_page?(admin_rooms_path) ? 'border-indigo-500 text-gray-900' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300' %> text-sm font-medium whitespace-nowrap">
                    회의실
                    <svg class="ml-1 h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                    </svg>
                  </button>
                  <div class="hidden absolute z-10 left-0 mt-1 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5"
                       data-dropdown-target="menu">
                    <div class="py-1">
                      <%= link_to "카테고리", admin_room_categories_path,
                          class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
                      <%= link_to "회의실", admin_rooms_path,
                          class: "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100" %>
                    </div>
                  </div>
                </div>

                <!-- 승인자 그룹 단독 메뉴 -->
                <%= link_to "승인자 그룹", admin_approver_groups_path,
                    class: "#{current_page?(admin_approver_groups_path) ? 'border-indigo-500 text-gray-900' : 'border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700'} inline-flex items-center px-2 py-2 border-b-2 text-sm font-medium whitespace-nowrap" %>
              </div>
            </div>
            <div class="flex items-center space-x-4">
              <span class="text-sm text-gray-500">관리자: <%= current_user&.name %></span>
              <%= link_to "일반 화면으로", root_path, class: "text-sm text-blue-600 hover:text-blue-800" %>
            </div>
          </div>
        </div>
      </nav>

      <!-- Flash messages -->
      <div id="flash_container"></div>
      <div id="flash">
        <%= render 'shared/flash' %>
      </div>

      <!-- Main content -->
      <main>
        <%= yield %>
      </main>
    </div>
  </body>
</html>